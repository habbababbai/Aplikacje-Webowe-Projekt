!function(e){var t={};function l(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=t,l.d=function(e,t,i){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(i,a,function(t){return e[t]}.bind(null,a));return i},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=4)}([function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colors={ship:"Black",empty:"White",hit:"Red",miss:"Pink",hover:"Grey"}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Empty=0]="Empty",e[e.Ship=1]="Ship",e[e.Hit=2]="Hit",e[e.Miss=3]="Miss"}(t.CellState||(t.CellState={}))},function(e,t,l){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)Object.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=l(0),o=l(7),s=l(1),r=l(3),n=i(l(8));t.Board=class{constructor(e){this.cellTable=[],this.cellTable=[];for(let t=0;t<e.length;t++)this.cellTable.push(new o.Cell(e[t]))}placeHorizontal(e,t){for(let l=e;l<e+t;l++)this.cellTable[l].state=s.CellState.Ship}placeVertical(e,t){for(let l=e;l<e+t*n.DIMENSION_LENGTH;l+=n.DIMENSION_LENGTH)this.cellTable[l].state=s.CellState.Ship}canPlaceHorizontal(e,t){if(e%n.DIMENSION_LENGTH+t>n.DIMENSION_LENGTH)return!1;if(e+t>this.cellTable.length)return!1;for(let l=e;l<e+t;l++)if(this.cellTable[l].state!=s.CellState.Empty)return!1;return!0}canPlaceVertical(e,t){if(Math.floor(e/n.DIMENSION_LENGTH)+t>n.DIMENSION_LENGTH)return!1;for(let l=e;l<e+t*n.DIMENSION_LENGTH;l+=n.DIMENSION_LENGTH)if(this.cellTable[l].state!=s.CellState.Empty)return!1;return!0}setBoardRandomly(){this.placeRandomly(5),this.placeRandomly(4),this.placeRandomly(3),this.placeRandomly(2)}placeRandomly(e){let t;do{let l=r.getRandomInt(0,this.cellTable.length-1);this.canPlaceHorizontal(l,e)&&(this.placeHorizontal(l,e),t=!0),this.canPlaceVertical(l,e)&&(this.placeVertical(l,e),t=!0)}while(!t)}resetBoard(){for(let e=0;e<this.cellTable.length;e++)this.cellTable[e].button.style.backgroundColor=a.colors.empty,this.cellTable[e].state=s.CellState.Empty,this.cellTable[e].button.onclick=function(){}}disableBoard(){for(let e=0;e<this.cellTable.length;e++)this.cellTable[e].button.onclick=function(){},this.cellTable[e].button.onmouseover=function(){},this.cellTable[e].button.onmouseout=function(){}}setCell(e,t){switch(this.cellTable[e].state=t,t){case s.CellState.Empty:this.cellTable[e].button.style.backgroundColor=a.colors.empty;break;case s.CellState.Ship:this.cellTable[e].button.style.backgroundColor=a.colors.ship;break;case s.CellState.Miss:this.cellTable[e].button.style.backgroundColor=a.colors.miss;break;case s.CellState.Hit:this.cellTable[e].button.style.backgroundColor=a.colors.hit}}}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=l(5);window.onload=()=>{let e=Array.prototype.slice.call(document.getElementById("playerTable").querySelectorAll("button")),t=Array.prototype.slice.call(document.getElementById("enemyTable").querySelectorAll("button")),l=new i.Game(e,t),a=document.getElementById("ship5"),o=document.getElementById("ship4"),s=document.getElementById("ship3"),r=document.getElementById("ship2"),n=document.getElementById("orientation"),c=document.getElementById("reset"),h=document.getElementById("startGame"),u=document.getElementById("random"),d=[a,o,s,r,n,u,h];function p(e){l.pBoard.chooseShip(e)}function b(e){e.disabled=!0}a.addEventListener("click",()=>{p(5),b(a),b(u)}),o.addEventListener("click",()=>{p(4),b(o),b(u)}),s.addEventListener("click",()=>{p(3),b(s),b(u)}),r.addEventListener("click",()=>{p(2),b(r),b(u)}),n.addEventListener("click",(function(){l.changePlacingOrientation()})),c.addEventListener("click",(function(){l.resetGame();for(let e=0;e<d.length;e++)d[e].disabled=!1})),h.addEventListener("click",()=>function(){if(l.startGame(),l.pBoard.areShipsPlaced())for(let e=0;e<d.length;e++)d[e].disabled=!0;else alert("You need to place all ships!")}()),u.addEventListener("click",()=>function(){l.pBoard.setBoardRandomly();for(let e=0;e<4;e++)d[e].disabled=!0}())}},function(e,t,l){"use strict";var i=this&&this.__awaiter||function(e,t,l,i){return new(l||(l=Promise))((function(a,o){function s(e){try{n(i.next(e))}catch(e){o(e)}}function r(e){try{n(i.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?a(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(s,r)}n((i=i.apply(e,t||[])).next())}))},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)Object.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=l(0),s=l(1),r=l(6),n=l(2),c=l(3),h=a(l(8));t.Game=class{constructor(e,t){this.pBoard=new r.PlayerBoard(e),this.eBoard=new n.Board(t),this.pHitCounter=0,this.eHitCounter=0}changePlacingOrientation(){this.pBoard.placingHorizontal=!this.pBoard.placingHorizontal}startGame(){this.pBoard.areShipsPlaced()&&this.activateEnemyBoard()}activateEnemyBoard(){this.eBoard.setBoardRandomly();for(let e=0;e<this.eBoard.cellTable.length;e++)this.eBoard.cellTable[e].button.onclick=()=>this.shootEnemyCell(this.eBoard.cellTable[e]),console.log(this.pBoard.getNeighbours(e))}shootPlayerCell(){let e=this.pBoard.getHitNeighbours();Array.isArray(e)&&e.length?this.searchingShot():this.randomShot()}randomShot(){let e=this.pBoard.getEmptyCells(),t=c.getRandomInt(0,e.length-1);this.playerCellState(e[t])==s.CellState.Empty&&this.pBoard.setCell(e[t],s.CellState.Miss),this.playerCellState(e[t])==s.CellState.Ship&&(this.pBoard.setCell(e[t],s.CellState.Hit),this.pHitCounter++)}searchingShot(){let e=this.pBoard.getHitNeighbours(),t=c.getRandomInt(0,e.length-1);this.playerCellState(e[t])==s.CellState.Empty&&this.pBoard.setCell(e[t],s.CellState.Miss),this.playerCellState(e[t])==s.CellState.Ship&&(this.pBoard.setCell(e[t],s.CellState.Hit),this.pHitCounter++)}delay(e){return new Promise(t=>setTimeout(t,e))}shootEnemyCell(e){return i(this,void 0,void 0,(function*(){switch(e.state){case s.CellState.Empty:e.state=s.CellState.Miss,e.button.style.backgroundColor=o.colors.miss;break;case s.CellState.Ship:e.state=s.CellState.Hit,e.button.style.backgroundColor=o.colors.hit,this.eHitCounter++}yield this.delay(100),this.shootPlayerCell(),yield this.delay(200),this.checkForWin()}))}playerCellState(e){return this.pBoard.cellTable[e].state}checkForWin(){return this.pHitCounter==h.MAX_HITS?(this.eBoard.disableBoard(),alert("CPU Won!"),!0):this.eHitCounter==h.MAX_HITS&&(this.eBoard.disableBoard(),alert("Player won!"),!0)}resetGame(){this.pBoard.resetBoard(),this.pBoard.disableBoard(),this.eBoard.resetBoard(),this.eBoard.disableBoard(),this.eHitCounter=0,this.pHitCounter=0,this.pBoard.is5Placed=!1,this.pBoard.is4Placed=!1,this.pBoard.is3Placed=!1,this.pBoard.is2Placed=!1}}},function(e,t,l){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)Object.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=l(0),o=l(2),s=l(1),r=i(l(8));class n extends o.Board{constructor(e){super(e),this.placingHorizontal=!0,this.is5Placed=!1,this.is4Placed=!1,this.is3Placed=!1,this.is2Placed=!1,this.shipsPlaced=[this.is2Placed,this.is3Placed,this.is4Placed,this.is5Placed]}getEmptyCells(){let e=[];for(let t=0;t<this.cellTable.length;t++)t%2==0&&(this.cellTable[t].state!=s.CellState.Empty&&this.cellTable[t].state!=s.CellState.Ship||e.push(t));return e}getHitCells(){let e=[];for(let t=0;t<this.cellTable.length;t++)this.cellTable[t].state==s.CellState.Hit&&e.push(t);return e}getHitNeighbours(){let e=this.getHitCells(),t=[];for(let l=0;l<e.length;l++)t=t.concat(this.getNeighbours(e[l]));return t=t.filter(e=>this.cellTable[e].state!=s.CellState.Miss&&this.cellTable[e].state!=s.CellState.Hit),t}getNeighbours(e){let t=[];return e>r.FIRST_ROW_LAST_INDEX&&t.push(e-r.DIMENSION_LENGTH),e<r.LAST_ROW_FIRST_INDEX&&t.push(e+r.DIMENSION_LENGTH),e%r.DIMENSION_LENGTH!=0&&t.push(e-1),(e-r.FIRST_ROW_LAST_INDEX)%r.DIMENSION_LENGTH!=0&&t.push(e+1),t}setShip(e,t){let l=!1;if(this.placingHorizontal?this.canPlaceHorizontal(e,t)&&(this.placeHorizontal(e,t),l=!0):this.canPlaceVertical(e,t)&&(this.placeVertical(e,t),l=!0),l){switch(t){case 2:this.is2Placed=!0;break;case 3:this.is3Placed=!0;break;case 4:this.is4Placed=!0;break;case 5:this.is5Placed=!0}this.resetButtonEvents()}}setBoardRandomly(){this.placeRandomly(5),this.placeRandomly(4),this.placeRandomly(3),this.placeRandomly(2),this.is5Placed=!0,this.is4Placed=!0,this.is3Placed=!0,this.is2Placed=!0}areShipsPlaced(){return!!(this.is5Placed&&this.is4Placed&&this.is3Placed&&this.is2Placed)}anyShipPlaced(){return!!(this.is5Placed||this.is4Placed||this.is3Placed||this.is2Placed)}resetButtonEvents(){for(let e=0;e<this.cellTable.length;e++)this.cellTable[e].button.onclick=function(){},this.cellTable[e].button.onmouseover=function(){},this.cellTable[e].button.onmouseout=function(){}}placeHorizontal(e,t){for(let l=e;l<e+t;l++)this.cellTable[l].button.style.backgroundColor=a.colors.ship,this.cellTable[l].state=s.CellState.Ship}placeVertical(e,t){for(let l=e;l<e+t*r.DIMENSION_LENGTH;l+=r.DIMENSION_LENGTH)this.cellTable[l].button.style.backgroundColor=a.colors.ship,this.cellTable[l].state=s.CellState.Ship}chooseShip(e){if(!this.shipsPlaced[e-2])for(let t=0;t<this.cellTable.length;t++)this.cellTable[t].button.onclick=()=>{this.setShip(t,e)},this.cellTable[t].button.onmouseover=()=>{this.hover(t,e,a.colors.hover)},this.cellTable[t].button.onmouseout=()=>{this.hover(t,e,a.colors.empty)}}hover(e,t,l){if(this.placingHorizontal){if(this.canPlaceHorizontal(e,t))for(let i=e;i<e+t;i++)this.cellTable[i].button.style.backgroundColor=l}else if(this.canPlaceVertical(e,t))for(let i=e;i<e+t*r.DIMENSION_LENGTH;i+=r.DIMENSION_LENGTH)this.cellTable[i].button.style.backgroundColor=l}}t.PlayerBoard=n},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=l(0),a=l(1);t.Cell=class{constructor(e){this.state=a.CellState.Empty,this.button=e,this.button.style.backgroundColor=i.colors.empty}}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TABLE_LENGTH=49,t.DIMENSION_LENGTH=7,t.MAX_HITS=14,t.FIRST_ROW_LAST_INDEX=t.DIMENSION_LENGTH-1,t.LAST_ROW_FIRST_INDEX=t.TABLE_LENGTH-t.DIMENSION_LENGTH}]);